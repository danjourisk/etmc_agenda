%% This TeX file is created for ETMC Toastmasters to generate 
%% meeting agenda in an easy way, and with high quality typesetting.
%% Thanks for your interest. Any comments on this TeX program 
%% would be appreciated.
%%
%% This file is an input file for TeX, a free typesetting software, 
%% The output of TeX is a dvi file which can be easily converted to pdf,
%% and various other formats. TeX is available as 'texlive 2015'. 
%% After your installation with texlive, you can simply type:
%%
%%                  tex agenda.tex
%%
%% To get a dvi format and convert it to any format you like,
%% of course, using various tools.
%% 
%% 
%% This program uses pstricks,epsf and colortab macro package. It has 
%% FOUR SECTIONS, as shown in the following:
%%
%%   SECTION 1 : USER INFORMATION 
%%   SECTION 2 : ENVIRONMENTAL MACRO
%%   SECTION 3 : FORMAT DEFINE
%%   SECTION 4 : PAGE MAKER
%%
%%
%% If you just need a new agenda, modify SECTION1 by filling in 
%% your information, and then compile to get dvi outputs.
%%
%% If you are interested in making this program more elegant 
%% and more adaptive, you can dig into section 2~4 to get an 
%% overall understanding of the whole program.
%% 
%% TeX is worth learning because it gives us freedom on typesetting
%% anything you like in an programmer way. You can contact me via 
%% danjourisk@163.com. You are welcomed to send me mail! 
%%
%% Tips: Remember comment sign '%' at end of a line can not be removed 
%% arbitrarily, it may lead to COMPILATION ERROR!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% SECTION 1 : USER INFORMATION 
%% NOTES: Please update meeting info by REPLACING contents in curl brackets.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% theme,timenote and venue
\def\themeinfo{Every One Could be a Leader}
\def\dateinfo{Jan 8th, 2016}
\def\timeinfo{12:05--13:30}
\def\venueinfo{Conf CN BJ WJ 1F (14) Mexico City, Ericsson Tower 1F}

%% club officer 
\def\president{Charles Li}
\def\saa{Xuefeng Wang}

%% vpm email address
\def\vpmemail{huan.liu@ericsson.com}

%% function role
\def\tmname{Liyu Huang}       \def\tmproject{CL5}        % Toastmaster   
\def\gename{Jie Zhang}        \def\geproject{CL8}        % General Evaluator
\def\timername{Xiao Qin}      \def\timerproject{CL4}     % Timer
\def\gramname{Amy Wang}       \def\gramproject{CL3}      % Grammarian
\def\ahname{Fangfang Liu}     \def\ahproject{CL1}        % Ah Counter
\def\ttmname{Rose Zheng}      \def\ttmproject{CL4}       % Table Topic Master
\def\ttename{Melanie Wang}    \def\tteproject{CL3}       % Table Topic Evaluator
\def\evaonename{Xiao Qin}     \def\evaoneproject{CL1}    % Speech Evaluator 1
\def\evatwoname{Xuefeng Wang} \def\evatwoproject{CL1}    % Speech Evaluator 2

%% speaker role
\def\spkonename{Yanping Dang}   % Speaker One
\def\spkoneproject{CC6}
\def\spkonetitle{Really Long Title of a Speech that is to be delivered
                 but you can not imagine how long it would be}  
\def\spkoneduration{6--8 min}  
\def\spkonetime{08:00}          % {min:sec}, e.g. 8min30sec type {08:30}  
\def\spktwoname{Huan Liu}       % Speaker Two
\def\spktwoproject{CC4}
\def\spktwotitle{Yoga and me}
\def\spktwoduration{4--6 min}  
\def\spktwotime{06:00}          % {min:sec}, e.g. 8min30sec type {08:30}  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% SECTION 2 : ENVIRONMENTAL MACRO
%% NOTES: Please do not modify this section unless you know what you are doing.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% import macro packages 
\input pstricks    % pstricks package for color support
\input epsf        % epsf package for eps image support
\input colortab    % colortab package for background color support in table

%% page layout set
\special{papersize=11.692in,8.267in}
\nopagenumbers
\hsize 5.4in
\vsize 7.3in
\hoffset -0.70in
\voffset -0.5in

%% agenda parameters set
\bigskipamount 9pt plus 30pt
\medskipamount 6pt plus 20pt
\smallskipamount 3pt plus 10pt 

\newdimen\boxmargin \boxmargin = 2pt
\newdimen\boxwidth \boxwidth = \hsize
\global\advance\boxwidth by 2\boxmargin

% font define
\font\supertitlefont = cmbx12 scaled \magstep4
\font\titlefont = cmbx12 scaled \magstep3
\font\subtitlefont = cmbx10 scaled \magstep3
\font\subsubtitlefont = cmbx10 scaled \magstephalf
\font\tabletitlefont = cmbx9
\font\tablebodyfont = cmr9

% color define
\newcmykcolor{skyblue}{.5 .24 .02 0}
\newcmykcolor{orange}{.03 .53 .74 0}
\newcmykcolor{bamboogreen}{.31 .09 .47 0}
\newcmykcolor{darkred}{.31 .81 .66 0}

%%%%%%%%%%%%%%%%%%%%% user data encapulation macro %%%%%%%%%%%%%%%%%%%

\def\ifstringeq#1#2{\def\stra{#1}\def\strb{#2}\ifx\stra\strb}

\def\tm[#1]{%
    \ifstringeq{#1}{project}\tmproject\fi
    \ifstringeq{#1}{name}\tmname\fi} 
\def\ge[#1]{%
    \ifstringeq{#1}{project}\geproject\fi
    \ifstringeq{#1}{name}\gename\fi} 
\def\timer[#1]{%
    \ifstringeq{#1}{project}\timerproject\fi
    \ifstringeq{#1}{name}\timername\fi} 
\def\gram[#1]{%
    \ifstringeq{#1}{project}\gramproject\fi
    \ifstringeq{#1}{name}\gramname\fi} 
\def\ah[#1]{%
    \ifstringeq{#1}{project}\ahproject\fi
    \ifstringeq{#1}{name}\ahname\fi} 
\def\ttm[#1]{%
    \ifstringeq{#1}{project}\ttmproject\fi
    \ifstringeq{#1}{name}\ttmname\fi} 
\def\tte[#1]{%
    \ifstringeq{#1}{project}\tteproject\fi
    \ifstringeq{#1}{name}\ttename\fi} 
\def\fstevl[#1]{%
    \ifstringeq{#1}{project}\evaoneproject\fi
    \ifstringeq{#1}{name}\evaonename\fi} 
\def\scdevl[#1]{%
    \ifstringeq{#1}{project}\evatwoproject\fi
    \ifstringeq{#1}{name}\evatwoname\fi} 
\def\fstspk[#1]{%
    \ifstringeq{#1}{project}\spkoneproject\fi
    \ifstringeq{#1}{name}\spkonename\fi
    \ifstringeq{#1}{title}\spkonetitle\fi
    \ifstringeq{#1}{time}\spkonetime\fi 
    \ifstringeq{#1}{duration}\spkoneduration\fi} 
\def\scdspk[#1]{%
    \ifstringeq{#1}{project}\spktwoproject\fi
    \ifstringeq{#1}{name}\spktwoname\fi
    \ifstringeq{#1}{title}\spktwotitle\fi
    \ifstringeq{#1}{time}\spktwotime\fi
    \ifstringeq{#1}{duration}\spktwoduration\fi} 

%%%%%%%%%%%%%%%%%%%%% time advance processing macro %%%%%%%%%%%%%%%%%%%%

\global\newcount\hour
\global\newcount\min
\global\newcount\sec
\global\newcount\tmphour
\global\newcount\tmpmin
\global\newcount\tmpsec

\def\settime#1:#2:#3 {\hour = #1\min = #2\sec = #3}
\def\showtime{\ifnum\hour<10 0\number\hour\else\number\hour\fi
                :\ifnum\min<10 0\number\min\else\number\min\fi}
\def\advancetime#1:#2 { % parameter : #1 min, #2 sec
    \tmphour = \hour %
    \tmpmin = \min %
    \tmpsec = \sec %
    \advance\tmpmin by #1 %
    \advance\tmpsec by #2 %
    \ifnum\tmpsec <60 %
        \global\sec = \tmpsec %
    \else %
        \global\advance\tmpmin by 1 %
        \advance\tmpsec by -60 %
        \global\sec = \tmpsec %
        \global\min = \tmpmin %
    \fi %
    \ifnum\tmpmin<60 %
        \global\min = \tmpmin %
    \else%
        \global\advance\tmphour by 1 %
        \advance\tmpmin by -60 %
        \global\min = \tmpmin %
        \global\hour = \tmphour %
    \fi} %

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% SECTION 3 : FORMAT DEFINE
%% NOTES : This section defines all format used in SECTION4
%%         Please do not modify this section unless you know what you are doing.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% main title
\def\title#1 {%
\noindent
\line{\hfil
    \epsfxsize = .6in \epsfbox{tmlogo.eps}
    \hskip 10pt\raise .15in\hbox{\titlefont#1}\hfil}%
}

%% Sub Title
\def\subtitle[#1]#2 {%
    \medskip
    {\noindent\tabskip=0pt
            \psframebox[fillstyle=solid,%
                        framesep=2pt,%
                        boxsep=false,%
                        linewidth=0pt,%
                        fillcolor=#1,%
                        linecolor=#1]
            {\hbox to \hsize{\white\subsubtitlefont\vphantom{pg}#2\hfil}}}%
    \medskip
}

%% theme
\def\theme#1 {%
    \medskip
    \line{\titlefont \hfil Theme\thinspace:\thinspace#1\hfil}%        
    \medskip
}

%% time
\def\ttime#1#2 {% named to avoid keyword time
    \smallskip
    \line{\hbox to .7in{\quad\bf Time\hfil}\bf#1\quad#2\hfil}%
    \smallskip
}


%% venue
\def\venue#1 {%
\smallskip
\line{\hbox to .7in{\quad\bf Venue\hfil}\bf#1\hfil}%
\smallskip
}

%% output routine

\output{%
    \offinterlineskip
    \ifodd\pageno
        \global\setbox254\vbox{%
            \hrule 
            \hbox{\vrule\kern\boxmargin
                  \hbox to \hsize{\vphantom{\vrule height \boxmargin}\hfil}%
                  \kern\boxmargin\vrule}%
            \hbox{\vrule\kern\boxmargin
                  \vtop to \vsize{\unvbox255\kern\boxmargin}%
                  \kern\boxmargin\vrule}%
            \hrule
        }%
    \else
        \global\setbox253\vbox{%
            \hrule
            \hbox{\vrule\kern\boxmargin
                  \hbox to \hsize{\vphantom{\vrule height \boxmargin}\hfil}%
                  \kern\boxmargin\vrule}%
            \hbox{\vrule\kern\boxmargin
                  \vtop to \vsize{\unvbox255\kern\boxmargin}%
                  \kern\boxmargin\vrule}%
            \hrule
        }%
        \shipout\vbox{\hbox{\vtop{\unvbox254}\vtop{\unvbox253}}}%
    \fi
    \advancepageno
}%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% SECTION 4 : PAGE MAKER
%% NOTES : This section constructs each page of agenda.
%%         Please do not modify this section unless you know what you are doing.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% page 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\noindent\tabskip=0pt
        \psframebox[fillstyle=solid,%
                    framesep=2pt,%
                    boxsep=false,%
                    linewidth=0pt,%
                    fillcolor=darkred,%
                    linecolor=darkred]
        {\hbox to \hsize{\white\titlefont\vphantom{pg}vote for the best!\hfil}}}%
\vskip .1\vsize

\centerline{\epsfxsize = 2in \epsfbox{vote.eps}}
\vskip .01\vsize

\centerline{Scan and vote}
\centerline{\dateinfo}
\vskip .1\vsize

\centerline{\vbox{\vskip\baselineskip\hbox{\subsubtitlefont Best Speaker\hfil}%
                  \vskip\baselineskip\hbox{\subsubtitlefont Best Table Topic Speaker\hfil}%
                  \vskip\baselineskip\hbox{\subsubtitlefont Best Role\hfil}%
                  \vskip\baselineskip\hbox{\subsubtitlefont Best Evaluator\hfil}}}

\vfill
\break

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% page 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\leftline{\epsfxsize = .6in \epsfbox{tmlogo.eps}}
\vskip .02\vsize

\vskip \baselineskip\centerline{\subsubtitlefont Welcome to}
\vskip \baselineskip\centerline{\supertitlefont ERICSSON}
\vskip \baselineskip\centerline{\supertitlefont TOASTMASTERS CLUB}

\vskip .04\vsize

{\noindent\tabskip=0pt
        \psframebox[fillstyle=solid,%
                    framesep=2pt,%
                    boxsep=false,%
                    linewidth=0pt,%
                    fillcolor=darkred,%
                    linecolor=darkred]
        {\hbox to \hsize{\hfil\white\titlefont\vphantom{pg}Where Changes are Made!\hfil}}}%
\medskip

\vskip .08\vsize

\noindent\centerline{\hbox{\vtop{\hbox{\epsfxsize = 1.5in \epsfbox{wechat.eps}}
                                 \vskip .03\hsize
                                 \hbox to 1.5in{\hfil ETMC Wechat\hfil}}%
                           \hskip .1\hsize
                           \vbox{\vskip\baselineskip\hbox{\subsubtitlefont $\surd$ Listening Skill}%
                                 \vskip\baselineskip\hbox{\subsubtitlefont $\surd$ Communication Skill}%
                                 \vskip\baselineskip\hbox{\subsubtitlefont $\surd$ Public Speaking Chance}%
                                 \vskip\baselineskip\hbox{\subsubtitlefont $\surd$ Leadership Skill}%
                                 \vfill}}}%


\vskip .1\vsize
\centerline{\subtitlefont A fantastic journey is about to begin...}


\vfill
\break

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% page 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Ericsson Toastmasters Club}

\subtitle[skyblue]{About Toastmasters Internaltional}

Since 1924, Toastmasters International has been recognized
as the leading organization dedicated to communication and 
leadership skill development. Each week Toastmasters helps 
more than a quarter million men and women of every ethnicity, 
education level and profession build their competence in 
communication so they can gain the confidence to lead others. 
(For more information, please visit \underbar{\blue http://www.toastmasters.org})

\subtitle[skyblue]{About Ericsson Toastmasters Club}

Founded on September 27th, 2009 in Ericsson, Beijing. 
ETMC creates components for people to live long, healthy 
and happy. We make people laugh by the use of language. 
We help you become strong by serving and leading your team. 
Our mission is: Motivate to develop all members' potential. 
Support each other, grow together! If you are interested in 
our club, please contact VPM via \underbar{{\blue \vpmemail}}.

{\offinterlineskip
\medskip

\moveleft\boxmargin\vbox{\hbox to \hsize{\vbox{\hrule width \boxwidth}\hss}}
\kern 2pt
\moveleft\boxmargin\vbox{\hbox to \hsize{\vbox{\hrule width \boxwidth}\hss}}
}

\theme{\themeinfo}
\ttime{\dateinfo}{\timeinfo}
\venue{\venueinfo}

\subtitle[orange]{Important Notice}

\item {1.} Please mute your phone during the meeting.
\item {2.}Taboo: Politics, Religion, Race, Sex

\subtitle[orange]{Competence Leadership Planning}

\noindent CL project is a practical guide to becoming a better leader.
\medskip

\hbox to \hsize{\hfil\vbox{
{\tabskip = 0pt
\offinterlineskip
\def\hruleskip{\vphantom{\vrule height 2pt}&&\cr%
               \noalign{\hrule}% 
               \vphantom{\vrule height 2pt}&&\cr}
\halign{%
    \vrule\hbox to 0.4\hsize{\quad#\quad\hfil}%
        &\vrule\hbox to 0.25\hsize{\hfil\quad#\quad\hfil}%
        &\vrule\hbox to 0.25\hsize{\quad#\quad\hfil}\vrule\cr
    \noalign{\hrule}
    \vphantom{\vrule height 2pt}&&\cr
    \bf Role&\bf CL Project&\bf Owner\cr
    \hruleskip
    Toastmaster&\tm[project]&\tm[name]\cr
    \hruleskip
    General Evaluator&\ge[project]&\ge[name]\cr
    \hruleskip
    Timer&\timer[project]&\timer[name]\cr
    \hruleskip
    Grammarian&\gram[project]&\gram[name]\cr
    \hruleskip
    Ah-counter&\ah[project]&\ah[name]\cr
    \hruleskip
    Table Topic Master&\ttm[project]&\ttm[name]\cr
    \hruleskip
    Table Topic Evaluator&\tte[project]&\tte[name]\cr
    \hruleskip
    Evaluator 1&\fstevl[project]&\fstevl[name]\cr
    \hruleskip
    Evaluator 2&\scdevl[project]&\scdevl[name]\cr
    \vphantom{\vrule height 2pt}&&\cr
    \noalign{\hrule}
   } 
}}\hfil}
\bigskip
\break

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% page 4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\expandafter\settime 12:00:00

\offinterlineskip\tablebodyfont

\def\titlerow#1#2#3#4#5{%
    \bf#1&\bf#2&\bf#3&\bf#4&\bf#5\cr\noalign{\vskip 0pt plus 10pt\hrule}}%

\def\sessionrow#1{%
    \CC\bamboogreen&\bamboogreen&\bamboogreen&\bamboogreen&\bamboogreen\cr
         \noalign{\strut\hfil#1\hfil}\noalign{\hrule}%
    \ECC}

%\def\entryrow#1#2#3#4#5{\showtime&#1&#2&#3&#4\expandafter\gotime#5 \cr\noalign{\vskip 0pt plus 10pt\hrule}}%
\def\entryrow#1#2#3#4#5{\noalign{\vskip 0pt plus 10pt}
                        \showtime&#1&#2&#3&#4\expandafter\advancetime#5 \cr
                        \noalign{\vskip 0pt plus 10pt\hrule}}%

\coloralign{%
     \hbox to .10\hsize{\strut\hfil#\hfil}%  % Time
    &\hbox to .25\hsize{\ #\hfil}%           % Role
    &\hbox to .35\hsize{\vtop{\noindent\overfullrule 0pt\hsize .35\hsize#}}%    Conference Session       
    &\hbox to .16\hsize{\ #\hfil}%           % Member
    &\hbox to .13\hsize{\ \hfil#\hfil}\cr
    \titlerow{Time}{Role}{Conference Session}{Member}{Duration} 
%
    \sessionrow{Welcoming Session}
    \entryrow{}{Arrival Time}{}{5 min}{5:0}
    \entryrow{President}{Opening Speech}{\president}{1--2 min}{2:0}
    \entryrow{Toastmaster}{Welcome Speech}{\tm[name]} {2--3 min}{3:0}
    \entryrow{Toastmaster}{Greeting Guests}{\tm[name]} {1--2 min}{2:0}
    \entryrow{Toastmaster}{Introduce General Evaluator}{\tm[name]}{0--30 sec}{0:30}
    \entryrow{General Evaluator}{Introduce Evaluation Team}{\ge[name]}{1--2 min}{2:0}
    \entryrow{Timer}{Explain the Role}{\timer[name]}{1--2 min}{2:0}
    \entryrow{Grammarian}{Explain the Role}{\gram[name]}{2--3 min}{3:0}
    \entryrow{Ah Counter}{Explain the Role}{\ah[name]}{1--2 min}{2:0}
%
    \sessionrow{Table Topic \& Sharing Session}
    \entryrow{Toastmaster}{Introduce Table Topic Master}{\tm[name]}{0--30 sec}{0:30}
    \entryrow{Table Topic Master}{Conduct Table Topic Session}{\ttm[name]}{15 min}{15:0}
    \entryrow{Toastmaster}{Introduce Table Topic Evaluator}{\tte[name]}{0--30 sec}{0:30}
    \entryrow{Table Topic Evaluator}{Evaluate Table Topic Session}{\tm[name]}{4--6 min}{6:0}
    \entryrow{Toastmaster}{New Free Talk Session}{\tm[name]}{4--5 min}{5:0}
%
    \sessionrow{Speech \& Evaluation Session}
    \entryrow{Toastmaster}{Introduce Prepared Speaker 1}{\tm[name]}{0--30 sec}{0:30}
    \entryrow{Prepared Speaker 1}{\fstspk[project]--\fstspk[title]}{\fstspk[name]}{\fstspk[duration]}{\spkonetime}
    \entryrow{}{Make Comments on Speaker 1}{}{1 min}{1:0}
    \entryrow{Toastmaster}{Introduce Prepared Speaker 2}{\tm[name]}{0--30 sec}{0:30}
    \entryrow{Prepared Speaker 2}{\scdspk[project]--\scdspk[title]}{\scdspk[name]}{\scdspk[duration]}{\spktwotime}
    \entryrow{}{Make Comments on Speaker 2}{}{1 min}{1:0}
    \entryrow{Toastmaster}{Introduce Speech Evaluator 1}{\tm[name]}{0--30 sec}{0:30}
    \entryrow{Evaluator 1}{Evaluate Speaker 1}{\fstevl[name]}{2--3 min}{3:0}
    \entryrow{Toastmaster}{Introduce Speech Evaluator 2}{\tm[name]}{0--30 sec}{0:30}
    \entryrow{Evaluator 2}{Evaluate Speaker 2}{\scdevl[name]}{2--3 min}{3:0}
%
    \sessionrow{Report Session}
    \entryrow{Toastmaster}{Call Up Report}{\tm[name]}{0--30 sec}{0:30}
    \entryrow{Grammarian}{Grammer Report}{\gram[name]}{1--2 min}{2:0}
    \entryrow{Ah Counter}{Ah Report}{\ah[name]}{1--2 min}{2:0}
    \entryrow{Timer}{Time Report}{\timer[name]}{1--2 min}{2:0}
    \entryrow{Toastmaster}{Call General Evaluator}{\tm[name]}{0--30 sec}{0:30}
    \entryrow{General Evaluator}{Evaluate Meeting}{\ge[name]}{4--5 min}{5:0}
    \entryrow{}{Silence for Voting Best}{}{1 min}{1:0}
    \entryrow{Sergeant at Arms}{Announce Best \& Photo Time}{\saa}{1 min}{1:0}
    \entryrow{President}{Closing Speech}{\president}{1--2 min}{2:0}
}%

\supereject\end


